<section class="cart section--lg container">
        <div class="table__container">
          <table class="table">
            <thead>
              <tr>
                <th>Image</th>
                <th>Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Subtotal</th>
                <th>Rename</th>
              </tr>
            </thead>
            <tbody>
              
              
              {% for product in products %}
                <tr>
                <td>
                  <img
                    src=""
                    alt=""
                    class="table__img"
                  />
                </td>
                <td>
                  <h3 class="table__title">
                    {{product.name}}
                  </h3>
                </td>
                <td>
                  <span class="table__price"></span>
                </td>
                <td><input type="number" value="3" class="quantity" /></td>
                <td><span class="subtotal">$220</span></td>
                <td><i class="fi fi-rs-trash table__trash"></i></td>
              </tr>
              {% endfor %}
                
            
            </tbody>
          </table>
        </div>

        <div class="cart__actions">
          <a href="#" class="btn flex btn__md">
            <i class="fi-rs-shuffle"></i> Update Cart
          </a>
          <a href="#" class="btn flex btn__md">
            <i class="fi-rs-shopping-bag"></i> Continue Shopping
          </a>
        </div>

        <div class="divider">
          <i class="fi fi-rs-fingerprint"></i>
        </div>

        <div class="cart__group grid">
          <div>
            <div class="cart__shippinp">
              <h3 class="section__title">Calculate Shipping</h3>
              <form action="" class="form grid">
                <input
                  type="text"
                  class="form__input"
                  placeholder="State / Country"
                />
                <div class="form__group grid">
                  <input type="text" class="form__input" placeholder="City" />
                  <input
                    type="text"
                    class="form__input"
                    placeholder="PostCode"
                  />
                </div>
                <div class="form__btn">
                  <button class="btn flex btn--sm">
                    <i class="fi-rs-shuffle"></i> Update
                  </button>
                </div>
              </form>
            </div>
            <div class="cart__coupon">
              <h3 class="section__title">Apply Coupon</h3>
              <form action="" class="coupon__form form grid">
                <div class="form__group grid">
                  <input
                    type="text"
                    class="form__input"
                    placeholder="Enter Your Coupon"
                  />
                  <div class="form__btn">
                    <button class="btn flex btn--sm">
                      <i class="fi-rs-label"></i> Aplly
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>

          <div class="cart__total">
            <h3 class="section__title">Cart Totals</h3>
            <table class="cart__total-table">
                <tr>
                  <td><span class="cart__total-title">Cart Subtotal</span></td>
                  <td><span class="cart__total-price">$240.00</span></td>
                </tr>
                <tr>
                  <td><span class="cart__total-title">Shipping</span></td>
                  <td><span class="cart__total-price">$10.00</span></td>
                </tr>
                <tr>
                  <td><span class="cart__total-title">Total</span></td>
                  <td><span class="cart__total-price">$250.00</span></td>
                </tr>
            </table>
            <a href="checkout.html" class="btn flex btn--md">
              <i class="fi fi-rs-box-alt"></i> Proceed To Checkout
            </a>
          </div>
        </div>
      </section>

   <script>
  document.addEventListener('DOMContentLoaded', function() {
      const addToCartButtons = document.addEventListener('#add_cart');
      
      addToCartButtons.forEach(button => {
          button.addEventListener('click', function(e) {
              e.preventDefault();
              
              // Product ID ni olish (data atribut yoki boshqa usulda)
              const productId = this.getAttribute('data-product-id');
              
              if (!productId) {
                  console.error('Product ID topilmadi!');
                  return;
              }
              
              // AJAX so'rov yuborish
              fetch(`/cart/add/${productId}`, {
                  method: 'GET',
                  headers: {
                      'Content-Type': 'application/json',
                      'X-Requested-With': 'XMLHttpRequest'
                  },
                  body: JSON.stringify({
                      quantity: 1 // Kerak bo'lsa miqdorni o'zgartirish mumkin
                  })
              })
              .then(response => response.json())
              .then(data => {
                  if (data.success) {
                      // Muvaffaqiyatli qo'shildi
                      console.log('Mahsulot savatga qo\'shildi!');
                      let count_cart = document.querySelectorAll
                      count_cart.textContent = data['cart_count']
                      // Icon o'zgarishi (ixtiyoriy)
                      const icon = this.querySelector('i');
                      icon.classList.remove('fi-rs-shopping-bag-add');
                      icon.classList.add('fi-rs-check');
                      
                      // Savat sonini yangilash (agar kerak bo'lsa)
                      updateCartCount();
                      
                      // 2 soniyadan keyin ikonni qaytarish
                      setTimeout(() => {
                          icon.classList.remove('fi-rs-check');
                          icon.classList.add('fi-rs-shopping-bag-add');
                      }, 2000);
                  } else {
                      console.error('Xatolik:', data.message);
                      alert(data.message || 'Xatolik yuz berdi!');
                  }
              })
              .catch(error => {
                  console.error('So\'rov xatosi:', error);
                  alert('Tarmoq xatosi yuz berdi!');
              });
          });
      });
  });
</script>